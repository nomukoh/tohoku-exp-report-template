\documentclass[lualatex,ja=standard]{bxjsarticle}

\setpagelayout{noheadfoot,top=1.5cm,bottom=1.5cm,left=2cm,right=2cm}}
\setlength{\footskip}{6mm}

% タイトル情報（必要に応じて編集）
\title{タイトル}
\author{著者}
\date{\today}

% パッケージ類
\usepackage{graphicx}   % 画像を挿入するため
\usepackage{amsmath}    % 数式を使うため
\usepackage{amssymb}    % 数式を使うため
\usepackage{caption}    % 図表のキャプション
\usepackage{subcaption} % サブキャプション
\usepackage{siunitx}    % 数式の設定
\usepackage{float}      % 図の配置設定
\usepackage{booktabs}   % 表のスタイル
\usepackage{multirow}   % 表のスタイル
\usepackage{pdfpages}   % 表紙の挿入
\usepackage{enumitem}   % 箇条書き
\usepackage{titlesec}   % セクションのスタイル
\usepackage{luatexja-fontspec} % フォント設定
\usepackage{xspace}     % スタイルの装飾
\usepackage{makecell}   % 表のセルを結合するため
\usepackage{ascmac}     % 図の枠を作成するため
\usepackage{listings}   % ソースコードの表示
\usepackage{comment}    % コメントの使用
\usepackage{fancyhdr}   % ヘッダー・フッター

\usepackage{hyperref}   % 図表へのリンク

% フォント
\setmainjfont{IPAexMincho} 
\AtBeginDocument{%lst
  \fontsize{10.5pt}{16pt}\selectfont
}

% 樹形図
\usepackage{tikz}
\usetikzlibrary{graphs, graphdrawing, arrows.meta, calc}
\usegdlibrary{trees}  % trees 用ライブラリ

% セクションスタイル
\newcommand{\mysectionstyle}[2]{%
  \sffamily         % 欧文・数字→サンセリフ
  \gtfamily         % 日本語→ゴシック
  \bfseries
  \fontsize{#1}{#2}\selectfont
}

% セクションのスタイル
\titleformat{\section}
  {\mysectionstyle{12pt}{16pt}}
  {\mysectionstyle{12pt}{16pt}\thesection.}
  {0.7em}{}
\titlespacing*{\section}{0em}{1em}{0em}

% サブセクションのスタイル
\titleformat{\subsection}
  {\mysectionstyle{10.5pt}{16pt}}
  {\mysectionstyle{10.5pt}{16pt}\thesubsection.}
  {0.7em}{}
\titlespacing*{\subsection}{0em}{0.5em}{0em}

% サブサブセクションのスタイル
\titleformat{\subsubsection}
  {\mysectionstyle{10.5pt}{12pt}}
  {\mysectionstyle{10.5pt}{12pt}\thesubsubsection.}
  {0em}{}
\titlespacing*{\subsubsection}{0em}{0.5em}{0em}

% パラグラフのスタイル
\titleformat{\paragraph}
  {\mysectionstyle{10.5pt}{12pt}}
  {\mysectionstyle{10.5pt}{12pt}\theparagraph.} 
  {0em}{}
\titlespacing*{\paragraph}{0em}{0em}{0em}

% サブパラグラフのスタイル
\titleformat{\subparagraph}
  {\mysectionstyle{8pt}{12pt}}
  {\mysectionstyle{8pt}{12pt}\thesubparagraph.}
  {0em}{}
\titlespacing*{\subparagraph}{0em}{0em}{0em}

% 和文キャプション
\renewcommand{\figurename}{図}
\renewcommand{\tablename}{表}
\renewcommand{\refname}{参考文献}
\renewcommand{\lstlistingname}{ソースコード}

% autoref の和文化
\renewcommand*{\figureautorefname}{図}
\renewcommand*{\tableautorefname}{表}
\renewcommand*{\equationautorefname}{式}
\renewcommand*{\subfigureautorefname}{図}

\captionsetup[subfigure]{labelformat=simple}
\renewcommand*{\thesubfigure}{(\alph{subfigure})}

\captionsetup[subtable]{labelformat=simple}
\renewcommand*{\thesubtable}{(\alph{subtable})}

% ブラケット付き単位の設定
\NewDocumentCommand{\sibr}{m}{\,\text{[\si{#1}]}}

% ソースコード用の設定
\lstset{
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\small\textnormal},
  keywordstyle={\small\bfseries},
  keepspaces=true,
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
  %columns=fixed, % 文字幅を合わせる
  numbers=left,
  xrightmargin=0em,
  xleftmargin=3em,
  numbersep=1em,
  numberstyle={\scriptsize},
  stepnumber=1,
  lineskip=-0.5ex
}

% リンクの色設定
\hypersetup{
  colorlinks=true,
  linkcolor=black,
  citecolor=black,
  urlcolor=black
}

% 参考文献の設定
\usepackage[backend=biber, style=numeric, sorting=none]{biblatex}
\addbibresource{refs.bib}

% --- 基本的な区切り文字と書式の設定 ---
\renewcommand*{\newunitpunct}{，}       % 各項目の区切りを「，」に
\renewcommand*{\finentrypunct}{．}      % 末尾を「．」に
\DeclareDelimFormat{multinamedelim}{，} % 著者名間の区切り
\DeclareDelimFormat{finalnamedelim}{，} % 最後の著者名の区切り

% --- フィールドごとの書式設定 ---

% タイトル：論文・章・Webは二重引用符、書籍・雑誌はそのまま
\DeclareFieldFormat{title}{#1} 
\DeclareFieldFormat[article,inbook,incollection,online]{title}{“#1，”} 
\DeclareFieldFormat{journaltitle}{#1}
\DeclareFieldFormat{booktitle}{#1}

% ページ番号：pp. を付ける
\DeclareFieldFormat{pages}{pp.#1}

% URLと参照日
\DeclareFieldFormat{url}{#1}
\DeclareFieldFormat{urldate}{，\thefield{urlyear}/\thefield{urlmonth}/\thefield{urlday}}

% --- 引用箇所の表示（[1]の上付き） ---
% ガイドには「[1]」とありますが、本文中で上付きにしたい場合はこのまま残してください。
% 普通の [1] にしたい場合は、以下の\DeclareCiteCommandブロックを削除してください。
\DeclareCiteCommand{\cite}
  {\usebibmacro{prenote}}
  {\mkbibsuperscript{[\printfield{labelnumber}]}}
  {\multicitedelim}
  {\usebibmacro{postnote}}

% --- ドライバ（表示順序）の設定 ---

% [1] 論文誌 (article)
% 著者名，“標題，” 雑誌名，巻，号，pp.始め－終り，月年．
\DeclareBibliographyDriver{article}{%
  \printnames{author}%
  \newunit\newblock
  \printfield{title}% 引用符とカンマはFieldFormatで処理
  \printfield{journaltitle}%
  \newunit\newblock
  \printfield{volume}%
  \newunit\newblock
  \printfield{number}%
  \newunit\newblock
  \printfield{pages}%
  \newunit\newblock
  % 日付（月・年）の処理
  \printdate
  \finentry
}

% [2] 著書・編書 (book)
% 著者名，書名，編者名，発行所，発行年．
% \DeclareBibliographyDriver{book}{%
%   \printnames{author}%
%   \newunit\newblock
%   \printfield{title}%
%   \newunit\newblock
%   \printnames{editor}%
%   \newunit\newblock
%   \printlist{publisher}%
%   \newunit\newblock
%   \printfield{year}%
%   \finentry
% }

% [3] 著書の一部 (book)
% 著者名，“標題，” 書名，編者名，章番号またはpp.，発行所，発行年．
\DeclareBibliographyDriver{book}{%
  \printnames{author}%
  \newunit\newblock
  \printfield{title}%
  \printfield{booktitle}%
  \newunit\newblock
  \printnames{editor}%
  \newunit\newblock
  \iffieldundef{chapter}
    {\printfield{pages}}
    {\printfield{chapter}}%
  \newunit\newblock
  \printlist{publisher}%
  \newunit\newblock
  \printfield{year}%
  \finentry
}

% [4] Webページ (online)
% “Web ページのタイトル”，URL アドレス，アクセスした日付．
\DeclareBibliographyDriver{online}{%
  \printfield{title}%
  \newunit\newblock
  \printfield{url}%
  % \newunitを入れるとカンマが入るが、urldateのフォーマット内にカンマを含めているためここは不要
  \printurldate
  \finentry
}

% 段落設定
\setlength{\parskip}{0.5em}
\setlength{\parindent}{1em}
\makeatletter
\AtBeginDocument{
  \let\@afterindentfalse\@afterindenttrue
}
\makeatother

% ヘッダーとフッター設定
\pagestyle{fancy}  % ページスタイルを変更
\fancyhf{}  % デフォルトのヘッダー・フッターをクリア
\renewcommand{\headrulewidth}{0pt} % ヘッダーの横線を削除
\fancyfoot[C]{\thepage}  % ページ番号を中央下に配置

% 外部ファイルの取り込み
\input{codeblock.tex}

\begin{document}

% 表紙（wordから出力した表紙をcover/cover.pdfに保存）
\includepdf[pages=1]{cover/cover.pdf}

% ページ番号をリセット
\pagenumbering{arabic}
\setcounter{page}{1}


\section{目的}


\section{原理}
\subsection{サブセクション1}

\begin{itemize}
\item ネットワーク層
\setlength{\parindent}{1em}



\vspace{1em}
\item トランスポート層（TCP，UDP）
\setlength{\parindent}{1em}



\end{itemize}


\begin{lstlisting}[language=C]
// プログラムコード

\end{lstlisting}


\section{方法}
\subsection{サブセクション1}


\subsection{サブセクション2}


\subsection{サブセクション3}


\begin{comment}
\section{結果}
\subsection{サブセクション1}

\begin{table}[H]
  \centering
  \caption{測定結果の例}
  \label{table:1}
  \begin{tabular}{c|cccc}
  \hline
       & 時間 $t$ [\textmu s] & 距離 $x$ [\textmu m] & 電圧値 $V$ [mV] \\
  \hline
  サンプル1     & 10           & 2.0            & 1.6       \\
  サンプル2     & 20           & 3.0            & 7.4       \\
  サンプル3     & 30           & 2.0            & 5.4       \\
  サンプル4     & 40           & 3.0            & 2.0       \\
  サンプル5     & 50           & 3.0            & 4.8       \\
  \hline
  \end{tabular}
\end{table}

\subsection{サブセクション2}


\subsection{サブセクション3}

\section{考察}
\subsection{サブセクション1}


\subsection{サブセクション2}


\subsection{サブセクション3}

\section{結論}
\end{ccomment}


\begin{comment}
\begin{figure}[H] % 横並び
  \centering
  \begin{minipage}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=0.8\textwidth]{img/2.jpg}
    \caption{実験装置1}
    \label{fig:2}
  \end{minipage}
  \hfill
  \begin{minipage}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=0.8\textwidth]{img/3.jpg}
    \caption{実験装置2}
    \label{fig:3}
  \end{minipage}
\end{figure}

\begin{figure}[htbp]% (a)と(b)で横並び
  \centering
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[scale=0.8]{img/4-a.jpg}
    \caption{実験回路1}
    \label{fig:4-a}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[scale=0.8]{img/4-b.jpg}
    \caption{実験回路2}
    \label{fig:4-b}
  \end{subfigure}
  \caption{横に並べた図の例}
  \label{fig:4-b}
\end{figure}
\end{comment}

\printbibliography[title=＜参考文献＞]

\end{document}
